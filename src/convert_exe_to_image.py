import numpy as np
import matplotlib.pyplot as plt


def file_size(file):
    import os
    filesize = os.stat(file)
    filesize_in_kb = filesize.st_size/1000
    return filesize_in_kb


def get_width(filesize):
    if filesize < 10:
        width = 32
    elif 10 <= filesize < 30:
        width = 64
    elif 30 <= filesize < 60:
        width = 128
    elif 60 <= filesize < 100:
        width = 256
    elif 100 <= filesize < 200:
        width = 384
    elif 200 <= filesize < 500:
        width = 512
    elif 500 <= filesize < 1000:
        width = 768
    else:
        width = 1024
    return width


def convert_exe_to_image(file):
    """

    :param file: exe file
    :return:  image in grayscale
    """
    filesize = file_size(file)
    colsize = get_width(filesize)
    f = open(file, 'r+b')
    list = []
    for each in f:
        for item in each:   
            list.append(item)
    myarray = np.asarray(list)
    length = myarray.shape
    rowsize = length[0] // colsize
    myarray = myarray[:rowsize*colsize]
    matrix = np.reshape(myarray, (rowsize, colsize))
    plt.gray()
    plt.imshow(matrix)
    plt.show()
