import numpy as np
from scipy.cluster.vq import vq, kmeans, whiten


def quantize_feature(feature_mat):
    """
    Run k-means to cluster the input feature vectors
    :param feature_mat: ndarray
            Row indicates the sample and column indicates the feature dim
    :return:
    """
    feature_obs = np.asarray(feature_mat)
    n_dims = feature_obs.shape[1]
    whitened = whiten(feature_obs)
    for codes in range(n_dims, 1, -5):
        codebook, distortion = kmeans(whitened, codes)
        print('k =', codes, 'distortion =', distortion)

